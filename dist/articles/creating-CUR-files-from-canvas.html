<html><head><meta http-equiv="content-type" content="text/html;charset=utf-8"/><title>Custom Cursors: Creating CUR Files from Canvas | Timm Preetz</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/><style></style><link rel="stylesheet" href="/assets/highlightjs.css"/></head><body><div id="navWrapper"><nav><a href="/" style="margin-right:20px;display:flex"><img src="/assets/ava.jpg" width="30" height="30" style="margin-top:5px;float:left;border-radius:2px"/><div class="name">Timm Preetz</div></a><div><a href="/projects">Projects</a>      <a href="/archive">Archive</a>      <a href="/about">About</a></div></nav></div><div id="mainWrapper" class="grt"><div class="contentWrapper"><div><h1>Custom Cursors: Creating CUR Files from Canvas</h1>
<p>A recent product design required switching various custom, dynamic cursors at runtime. These were prepared at runtime and drawn onto a <code>Canvas</code>:</p>
<p><video src="./cursor-example.mov" autoplay="true" loop="true" muted="true" width="108"></video></p>
<p>In Chrome and Firefox those canvases can be used as a cursor by setting the <code>cursor</code> property in CSS to <code>url(canvas.toDataURL())</code>. The data URL is guaranteed to contain a <code>base64</code> encoded <code>PNG</code> image of the canvas.</p>
<p>Edge though currently only supports <a href="https://en.wikipedia.org/wiki/ICO_(file_format)"><code>CUR</code> files</a>. Those files wrap the cursor image, optionally at different sizes, with some metadata. Luckily for us, a newer version of the CUR file format allows embedding <code>PNG</code> file data directly.</p>
<p>So I wrote a small library that reads a canvas into <code>PNG</code> blob and then inserts this data into a new <code>Blob</code> that builds up the <code>CUR</code> file. We can then create an <a href="https://developer.mozilla.org/en-US/docs/Web/API/URL/createObjectURL">“<code>object URL</code>”</a> of that <code>CUR</code> file which can be used in CSS similarly to the above method.</p>
<p>Example:</p>
<pre><code class="language-js"><span class="token comment">// call the `curObjectURLFromCanvas` function to retrieve an object URL pointing to a `CUR` file containing the canvas' image</span>
<span class="token keyword">const</span> cursorObjectURL <span class="token operator">=</span> <span class="token function">curObjectURLFromCanvas</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Use this URL in your inline style (or in a programatically created `StyleSheet`)</span>
body<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cursor <span class="token operator">=</span> <span class="token template-string"><span class="token string">`url(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cursorObjectURL<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">), pointer`</span></span><span class="token punctuation">;</span>
</code></pre>
<p>The library is called <code>cursor-utilities</code> and is available on <a href="https://www.npmjs.com/package/cursor-utilities">npm</a>, and the source is on <a href="https://github.com/tp/cursor-utilities">GitHub</a>.</p>
</div></div></div></body></html>